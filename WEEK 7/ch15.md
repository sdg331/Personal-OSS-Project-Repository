# Git 브랜치 개요와 관리 - 실습 가이드

## 📚 학습 목표

1. **브랜치의 필요성** 이해 및 실제 활용
2. **브랜치 생성과 이동** 명령어 실습
3. **브랜치 목록 확인 및 삭제** 작업 수행
4. 독립적인 브랜치에서 **커밋 작업 실습**

---

## 🎯 실습 준비

### 실습 환경 설정
이번 실습에서는 `gbrch`라는 저장소를 생성하여 브랜치의 동작을 직접 확인해보겠습니다.

---

## 1️⃣ 기본 브랜치 설정 실습

### 저장소 생성 및 기본 브랜치 확인

#### 단계별 실습

```bash
# 1. 전역 기본 브랜치를 main으로 설정
git config --global init.defaultBranch main

# 2. 새 저장소 생성
git init gbrch
# 출력: Initialized empty Git repository in C:/[smart git]/gbrch/.git/

# 3. 생성된 저장소로 이동
cd gbrch
```

#### 프롬프트 확인
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
```
- 프롬프트 마지막 `(main)`: 현재 작업 중인 브랜치 이름 표시

---

### 브랜치 이름 변경 실습

#### master → main으로 변경
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git branch -M master

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (master)
$ git branch -M main

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
```

#### 명령어 분석
- `git branch -M newBname`: 현재 브랜치 이름을 강제로 변경
- `-M`: Move/Rename (강제 옵션)
- 프롬프트의 브랜치 이름이 실시간으로 변경됨

---

## 2️⃣ 브랜치와 HEAD 실습

### 첫 번째 커밋 생성

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ touch README

$ git add README

$ git commit -m A
[main (root-commit) 7672f9e] A
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 README
```

#### 커밋 로그 확인
```bash
$ git log --oneline
7672f9e (HEAD -> main) A
```

#### 로그 해석
- `7672f9e`: 커밋 ID (해시값의 앞 7자리)
- `(HEAD -> main)`: HEAD가 main 브랜치를 가리키고, main은 커밋 7672f9e를 가리킴
- `A`: 커밋 메시지

### 시각화
```
README
  ↑
7672f9e (커밋 A)
  ↑
main ──────┐
           ↑
         HEAD
```
- **main 브랜치**: 생성된 커밋을 가리킴
- **HEAD**: 현재 작업 중인 브랜치(main)를 가리킴

---

### 두 번째 커밋 생성

```bash
$ touch hi.txt

$ git add hi.txt

$ git commit -m B
[main 34a7782] B
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 hi.txt
```

#### 로그 확인 (기본)
```bash
$ git log --oneline
34a7782 (HEAD -> main) B
7672f9e A
```

#### 로그 확인 (상세)
```bash
$ git log -p
```
- `-p`: patch 옵션, 각 커밋의 변경 내용(diff) 표시

### 시각화
```
README      README
  ↑         hi.txt
7672f9e  ←  34a7782 (커밋 B)
(A)           ↑
            main ──────┐
                       ↑
                     HEAD
```
- **main 브랜치**: 자동으로 최신 커밋 34a7782를 가리킴
- 커밋 34a7782는 부모 커밋 7672f9e를 가리킴

---

## 3️⃣ 새로운 브랜치 생성 실습

### 브랜치 생성 (이동 없음)

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git branch topic

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git branch
* main
  topic
```

#### 결과 분석
- `* main`: 현재 작업 중인 브랜치 (HEAD가 가리킴)
- `topic`: 생성된 브랜치
- 프롬프트는 여전히 `(main)` → HEAD가 이동하지 않음

### 시각화
```
README
hi.txt
  ↑
34a7782 (커밋 B)
  ↑      ↑
main   topic
  ↑
HEAD
```
- **topic 브랜치**: main과 동일한 커밋 34a7782를 가리킨다
- **HEAD**: 여전히 main을 가리킨다

---

## 4️⃣ 브랜치 목록 확인 실습

### 기본 브랜치 목록

```bash
$ git branch
* main
  topic
```
- `*` 표시: 현재 작업 중인 브랜치

### 상세 정보 포함

```bash
$ git branch -v
* main  34a7782 B
  topic 34a7782 B
```

#### 출력 정보
- **브랜치 이름**: main, topic
- **커밋 ID**: 34a7782
- **커밋 메시지**: B

### 로그에서 모든 브랜치 확인

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git log --oneline --all
34a7782 (HEAD -> main, topic) B
7672f9e A
```

#### 로그 해석
- `(HEAD -> main, topic)`: 
  - HEAD는 main을 가리킴
  - main과 topic 모두 커밋 34a7782를 가리킴
  - 현재 두 브랜치는 동일한 위치

---

## 5️⃣ 브랜치 이동 실습

### topic 브랜치로 이동

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git switch topic
Switched to branch 'topic'

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (topic)
```

#### 변화 확인
- 프롬프트가 `(main)`에서 `(topic)`으로 변경
- HEAD가 topic 브랜치로 이동

### 시각화
```
이동 전:
README
hi.txt
  ↑
34a7782
  ↑      ↑
main   topic
  ↑
HEAD

이동 후:
README
hi.txt
  ↑
34a7782
  ↑      ↑
main   topic
         ↑
       HEAD
```

### 이전 브랜치로 빠르게 복귀

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (topic)
$ git switch -
Switched to branch 'main'

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
```
- `git switch -`: 직전에 작업하던 브랜치로 이동
- 빠른 브랜치 전환에 매우 유용!

---

## 6️⃣ 분리된(Detached) HEAD 실습

### Detached HEAD 상태 만들기

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git switch -d HEAD~
HEAD is now at 7672f9e A

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch ((7672f9e...))
```

#### 명령어 분석
- `git switch -d HEAD~`: 
  - `-d` 또는 `--detach`: detached HEAD 모드로 이동
  - `HEAD~`: 현재 HEAD의 한 단계 이전 커밋

#### 프롬프트 변화
- `(main)` → `((7672f9e...))`: 브랜치가 아닌 커밋 ID 표시

### 파일 상태 확인

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch ((7672f9e...))
$ ls
README
```
- `hi.txt` 파일이 사라짐 (커밋 A 시점에는 존재하지 않았으므로)

### 시각화
```
README      README
  ↑         hi.txt
7672f9e  ←  34a7782
(A)         (B)
  ↑            ↑      ↑
HEAD         main   topic
(분리됨)
```

### 다시 브랜치로 복귀

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch ((7672f9e...))
$ git switch main
Previous HEAD position was 7672f9e A
Switched to branch 'main'

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
```

---

## 7️⃣ 브랜치에서 독립적 커밋 실습

### topic 브랜치에서 작업

#### 단계 1: topic 브랜치로 이동
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git switch topic
Switched to branch 'topic'
```

#### 단계 2: 새 파일 생성 및 커밋
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (topic)
$ echo 111 > to.txt

$ git add to.txt

$ git commit -m TOP1
[topic c6c76a4] TOP1
 1 file changed, 1 insertion(+)
 create mode 100644 to.txt
```

#### 단계 3: 작업 디렉토리 확인
```bash
$ ls
README  hi.txt  to.txt
```
- `to.txt` 파일이 topic 브랜치에만 존재

#### 단계 4: 로그 확인
```bash
$ git log --oneline --all
c6c76a4 (HEAD -> topic) TOP1
34a7782 (main) B
7672f9e A
```

### 시각화
```
README      README       README
  ↑         hi.txt       hi.txt
7672f9e  ←  34a7782  ←   to.txt
(A)         (B)          c6c76a4 (TOP1)
            ↑            ↑
          main         topic
                         ↑
                       HEAD
```
- **topic 브랜치만** 새로운 커밋 c6c76a4를 가리킴
- **main 브랜치**는 여전히 34a7782를 가리킴

---

### main 브랜치에서 독립적 작업

#### 단계 1: main 브랜치로 이동
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (topic)
$ git switch main
Switched to branch 'main'
```

#### 단계 2: main 브랜치의 로그 확인
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git log --oneline
34a7782 (HEAD -> main) B
7672f9e A
```
- main 브랜치에서는 topic 브랜치의 커밋(TOP1)이 보이지 않음

#### 단계 3: 모든 브랜치 로그 확인
```bash
$ git log --oneline --all
c6c76a4 (topic) TOP1
34a7782 (HEAD -> main) B
7672f9e A
```
- `--all`: 모든 브랜치의 커밋 표시

---

#### 단계 4: main 브랜치에서 새 파일 작성 및 커밋
```bash
$ echo main > ma.txt

$ git add ma.txt

$ git commit -m C
[main f25934d] C
 1 file changed, 1 insertion(+)
 create mode 100644 ma.txt
```

#### 단계 5: 전체 로그 확인
```bash
$ git log --oneline --all
f25934d (HEAD -> main) C
c6c76a4 (topic) TOP1
34a7782 B
7672f9e A
```

### 그래프로 로그 보기

```bash
$ git log --oneline --all --graph
* f25934d (HEAD -> main) C
| * c6c76a4 (topic) TOP1
|/
* 34a7782 B
* 7672f9e A
```

#### 그래프 해석
```
* f25934d (main)     ← main 브랜치의 최신 커밋
|                      
| * c6c76a4 (topic)  ← topic 브랜치의 최신 커밋
|/                   ← 분기점
* 34a7782            ← 공통 조상 커밋
* 7672f9e            ← 최초 커밋
```

### 최종 시각화
```
README      README       README
  ↑         hi.txt       hi.txt
7672f9e  ←  34a7782  ←   to.txt
(A)         (B)     ↑    c6c76a4 (TOP1)
                    |    ↑
                    └─   topic
                    README
                    hi.txt
                    ma.txt
                    f25934d (C)
                    ↑
                  main
                    ↑
                  HEAD
```

---

## 8️⃣ 로그 이력 점검 실습

### main 브랜치에서 로그 확인

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git log --oneline
f25934d (HEAD -> main) C
34a7782 B
7672f9e A
```
- **현재 브랜치(main)의 이력만** 표시
- topic 브랜치의 커밋은 보이지 않음

### 모든 브랜치 그래프로 보기

```bash
$ git log --oneline --graph --all
* f25934d (HEAD -> main) C
| * c6c76a4 (topic) TOP1
|/
* 34a7782 B
* 7672f9e A
```

---

### topic 브랜치로 이동 후 로그 확인

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git switch topic
Switched to branch 'topic'

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (topic)
$ git log --oneline
c6c76a4 (HEAD -> topic) TOP1
34a7782 B
7672f9e A
```
- **현재 브랜치(topic)의 이력만** 표시
- main 브랜치의 커밋 C는 보이지 않음

### topic 브랜치에서 전체 그래프

```bash
$ git log --oneline --graph --all
* f25934d (main) C
| * c6c76a4 (HEAD -> topic) TOP1
|/
* 34a7782 B
* 7672f9e A
```
- `HEAD -> topic`: 현재 위치가 topic 브랜치
- 모든 브랜치의 분기 구조를 시각적으로 확인

---

## 9️⃣ 이전 커밋에서 브랜치 생성 실습

### 복잡한 브랜치 구조 만들기

#### 단계 1: main 브랜치로 이동
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (topic)
$ git switch main
Switched to branch 'main'
```

#### 단계 2: 한 단계 이전 커밋으로 이동
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (main)
$ git checkout HEAD~
Note: switching to 'HEAD~'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by switching back to a branch.
...
HEAD is now at 34a7782 B
```

#### Detached HEAD 경고 메시지 이해
- Git은 브랜치 없이 작업하는 것을 경고
- 현재 상태에서 커밋하면 나중에 잃어버릴 수 있음
- 작업을 보존하려면 새 브랜치를 만들 것을 권장

---

#### 단계 3: hotfix 브랜치 생성 및 이동
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch ((34a7782...))
$ git switch -c hotfix
Switched to a new branch 'hotfix'

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (hotfix)
```
- `-c`: create, 새 브랜치 생성 + 이동
- Detached HEAD 상태를 벗어나 hotfix 브랜치에 연결

#### 단계 4: develop 브랜치 생성 및 이동
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (hotfix)
$ git checkout -b develop
Switched to a new branch 'develop'

파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (develop)
```
- hotfix와 develop 모두 같은 커밋 34a7782를 가리킴

---

#### 단계 5: 브랜치 목록 확인
```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (develop)
$ git branch
* develop
  hotfix
  main
  topic
```
- 총 4개의 브랜치가 존재
- `* develop`: 현재 작업 브랜치

#### 단계 6: 전체 구조 확인
```bash
$ git log --oneline --graph --all
* f25934d (main) C
| * c6c76a4 (topic) TOP1
|/
* 34a7782 (HEAD -> develop, hotfix) B
* 7672f9e A
```

### 최종 시각화
```
README      README       README
  ↑         hi.txt       hi.txt
7672f9e  ←  34a7782  ←   to.txt
(A)         (B)     ↑    c6c76a4 (TOP1)
            ↑   ↑   |    ↑
         hotfix |   └─   topic
         develop|        
            ↑   └──  README
          HEAD       hi.txt
                     ma.txt
                     f25934d (C)
                     ↑
                   main
```

#### 구조 분석
- **커밋 34a7782**: hotfix, develop 브랜치가 위치
- **커밋 f25934d**: main 브랜치가 위치
- **커밋 c6c76a4**: topic 브랜치가 위치
- 각 브랜치는 독립적으로 작업 가능

---

## 🔟 브랜치 삭제 실습

### hotfix 브랜치 삭제

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (develop)
$ git branch -d hotfix
Deleted branch hotfix (was 34a7782).
```

#### 출력 분석
- `Deleted branch hotfix`: 브랜치 삭제 성공
- `(was 34a7782)`: 삭제된 브랜치가 가리키던 커밋

### 삭제 후 로그 확인

```bash
파이썬@DESKTOP-8TN3J1L MINGW64 /c/[smart git]/gbrch (develop)
$ git log --oneline --graph --all
* f25934d (main) C
| * c6c76a4 (topic) TOP1
|/
* 34a7782 (HEAD -> develop) B
* 7672f9e A
```

#### 변화 확인
- `hotfix` 브랜치가 목록에서 사라짐
- 커밋 34a7782는 여전히 존재 (develop이 가리키고 있으므로)
- 브랜치는 포인터일 뿐, 삭제해도 커밋은 남아있음

### 시각화
```
삭제 전:
README
hi.txt
  ↑
34a7782 (B)
  ↑       ↑
hotfix  develop
          ↑
        HEAD

삭제 후:
README
hi.txt
  ↑
34a7782 (B)
  ↑
develop
  ↑
HEAD
```

---

## 1️⃣1️⃣ 브랜치 명령어 완전 정리

### checkout vs switch 상세 비교

| 작업 내용 | git checkout (구버전) | git switch (최신) |
|-----------|----------------------|-------------------|
| **이전 커밋으로 이동** | `git checkout [이전커밋]` | `git switch -d [이전커밋]` |
| **다른 브랜치로 이동** | `git checkout [branch]` | `git switch [branch]` |
| **새 브랜치 생성 + 이동** | `git checkout -b [newBranch]` | `git switch -c [newBranch]` |
| **이전 브랜치로 이동** | `git checkout -` | `git switch -` |

### 핵심 명령어 모음

#### 브랜치 조회
```bash
git branch              # 브랜치 목록
git branch -v           # 상세 정보 포함
git branch -h           # 도움말
```

#### 브랜치 생성
```bash
git branch <new-branch>          # 생성만 (이동 안 함)
git checkout -b <new-branch>     # 생성 + 이동 (구버전)
git switch -c <new-branch>       # 생성 + 이동 (최신)
```

#### 브랜치 이동
```bash
git checkout bname      # 브랜치 이동 (구버전)
git switch bname        # 브랜치 이동 (최신)
git checkout -          # 이전 브랜치로
git switch -            # 이전 브랜치로
```

#### 브랜치 삭제
```bash
git branch -d branch-name       # 일반 삭제 (병합된 것만)
git branch -D branch-name       # 강제 삭제 (병합 여부 무관)
```

---

## 💡 실습 체크리스트

### 완료해야 할 실습 목록
- [ ] 저장소 생성 및 기본 브랜치 설정
- [ ] 첫 번째 커밋 생성 후 HEAD 위치 확인
- [ ] 두 번째 커밋 생성 후 브랜치 자동 이동 확인
- [ ] 새 브랜치 생성 (이동 없이)
- [ ] `git branch -v`로 브랜치 상세 정보 확인
- [ ] 브랜치 이동 후 프롬프트 변화 확인
- [ ] `git switch -`로 이전 브랜치 왔다갔다 하기
- [ ] Detached HEAD 상태 만들고 파일 변화 관찰
- [ ] topic 브랜치에서 독립적으로 커밋
- [ ] main 브랜치로 돌아와서 독립적으로 커밋
- [ ] `git log --oneline --graph --all`로 분기 확인
- [ ] 이전 커밋에서 새 브랜치 2개 생성
- [ ] 브랜치 삭제 후 로그 변화 확인

---

## 🎓 학습 점검 질문

### 이해도 확인 (스스로 답해보세요)

1. **HEAD는 무엇을 가리키나요?**
   - 힌트: 브랜치? 커밋? 둘 다?

2. **`git branch topic`과 `git switch -c topic`의 차이는?**
   - 힌트: HEAD의 위치 변화를 생각해보세요

3. **Detached HEAD 상태에서 커밋하면 어떻게 될까요?**
   - 힌트: 브랜치에 연결되지 않으면?

4. **main 브랜치에서 `git log`를 실행하면 topic 브랜치의 커밋이 보일까요?**
   - 힌트: `--all` 옵션의 역할은?

5. **현재 작업 중인 브랜치를 삭제할 수 있나요?**
   - 힌트: develop 브랜치에서 develop을 삭제한다면?

---

## 🔍 추가 실험 과제

### 도전 과제 1: 3-way 브랜치 만들기
```bash
# main에서 시작해서
# feature1, feature2, bugfix 브랜치를 만들고
# 각각에서 서로 다른 파일로 커밋한 뒤
# 그래프로 구조를 확인해보세요
```

### 도전 과제 2: 브랜치 점프하기
```bash
# 5개의 브랜치를 만들고
# git switch -를 사용해
# 빠르게 브랜치 사이를 이동하는 연습
```

### 도전 과제 3: 로그 마스터 되기
```bash
# git log의 다양한 옵션 조합 시도:
# --oneline, --graph, --all
# --decorate, --pretty=format:
# 가장 보기 좋은 조합을 찾아보세요
```