# 30. 커밋 취소 (Git Revert) 완벽 정리

## 1. Revert(리버트) 개요
### 1.1 정의 및 개념
* **Revert**: 기존의 커밋 내용을 **'취소'하는 새로운 커밋을 생성**하여 이전 상태로 되돌리는 명령어.
* **Undo(실행 취소)**와 유사한 개념.
* **특징**:
    * 기존의 커밋 히스토리를 삭제하지 않고 그대로 유지함.
    * "이 커밋을 취소함"이라는 이력(Revert Commit)이 추가로 남음.
    * **협업(Collaboration) 시 필수**: 이미 원격 저장소(Remote)에 `Push`한 커밋을 되돌릴 때 사용해야 함.

### 1.2 왜 Reset 대신 Revert를 쓰는가?
* **Reset**: 시간을 과거로 되돌려버림 (이력이 삭제됨). -> **협업 시 팀원들의 코드와 충돌 발생 위험.**
* **Revert**: 잘못된 이력도 남기고, 이를 고친 이력도 남김. -> **협업 시 안전함.**

---

## 2. Revert vs Reset 비교 (핵심!)

| 구분 | Reset (리셋) | Revert (리버트) |
| :--- | :--- | :--- |
| **동작 방식** | 과거 특정 시점으로 **이동** (Rollback) | 특정 커밋의 정반대 내용을 담은 **새 커밋 생성** |
| **이력 관리** | 되돌린 이후의 이력은 **삭제됨** | 기존 이력 유지 + **취소 이력 추가** |
| **사용 시점** | **혼자 작업**하는 로컬 브랜치 | **이미 Push**하여 팀원과 공유된 브랜치 |
| **장점** | 히스토리가 깔끔해짐 | 히스토리가 보존되어 추적 가능(Safe) |

> ****
> *(Reset은 줄을 끊어버리고, Revert는 줄을 이어가며 매듭을 짓는 형태)*

---

## 3. [실습] Revert 명령어 상세 가이드

### 3.1 실습 환경 준비 (커밋 쌓기)
* 실습을 위해 3개의 커밋을 순서대로 쌓습니다.
```bash
# 1. 'Numeric' 커밋
$echo 123 > h$ git add h
$ git commit -m "Numeric"

# 2. 'Alphabet' 커밋
$ echo ABC >> h
$ git commit -am "Alphabet"

# 3. 'Alphanumeric' 커밋 (현재 HEAD)
$echo 1S >> h$ git commit -am "Alphanumeric"
````

### 3.2 가장 최근 커밋 취소하기 (`HEAD`)

  * **명령어**:
    ```bash
    $ git revert HEAD
    ```
  * **동작 과정**:
    1.  명령어 실행 시, 커밋 메시지를 작성하는 \*\*기본 에디터(Vim, Nano 등)\*\*가 자동으로 열림.
    2.  기본 메시지: `Revert "Alphanumeric"` (자동 생성됨).
    3.  저장하고 에디터를 닫으면 Revert가 완료됨.
  * **결과 확인**:
    ```bash
    $ cat h
    # 결과: 1S가 사라지고 123, ABC만 남음. (이전 상태로 복구됨)
    ```

### 3.3 에디터 없이 즉시 취소 (`--no-edit`)

  * **상황**: Revert 할 때마다 에디터가 뜨는 게 귀찮고, 자동 생성된 메시지를 그대로 쓰고 싶을 때.
  * **명령어**:
    ```bash
    $ git revert --no-edit HEAD
    ```
  * **결과**: 에디터 실행 과정 없이 바로 취소 커밋이 생성됨.

-----

## 4\. 고급 Revert 기능

### 4.1 특정 과거 커밋 취소하기

  * 바로 직전(`HEAD`)이 아니라, 한참 전의 커밋을 콕 집어서 취소할 수 있음.
  * **명령어**:
    ```bash
    $ git revert [커밋해시ID]
    ```
  * **주의**: 중간 단계의 커밋 건너뛰고 특정 내용만 빼내는 것이므로 \*\*충돌(Conflict)\*\*이 발생할 확률이 높음.

### 4.2 Revert 중 충돌 해결 및 취소

  * **상황**: Revert 과정에서 같은 라인을 건드려서 충돌이 발생한 경우.
  * **해결 방법**:
    1.  충돌 파일 수정 -\> `git add` -\> `git revert --continue`
  * **Revert 포기(취소) 방법**:
      * 충돌이 너무 복잡해서 Revert 자체를 없던 일로 하고 싶을 때.
    <!-- end list -->
    ```bash
    $ git revert --abort
    ```

-----

## 5\. 실습 로그 확인 (Log History)

  * Revert 후에는 히스토리가 어떻게 변하는지 확인하는 것이 중요함.

<!-- end list -->

```bash
$ git log --oneline
# (출력 예시)
# a1b2c3d (HEAD -> main) Revert "Alphanumeric"  <-- 취소 커밋이 새로 생김!
# e4f5g6h Alphanumeric                          <-- 실수했던 커밋도 그대로 있음
# h7i8j9k Alphabet
# ...
```

  * **해석**: `Alphanumeric` 커밋을 삭제한 것이 아니라, 그 효과를 상쇄하는 `Revert "..."` 커밋을 위에 덮어 씌운 구조.

-----

## 6\. 핵심 요약 (Summary)

1.  **Revert**는 "취소했다는 사실을 기록"하는 안전한 되돌리기 방법이다.
2.  **`git revert HEAD`**: 방금 한 커밋을 취소하는 새로운 커밋을 만든다.
3.  **`--no-edit`**: 귀찮은 에디터 창을 띄우지 않고 바로 처리한다.
4.  **`--abort`**: Revert 하다가 꼬이면 탈출한다.
5.  **공개된 저장소(GitHub 등)에 올린 코드는 반드시 Reset 말고 Revert로 되돌려야 한다.**