# 21. [실습] 임시저장 Stash (Lecture Notes)

## 1. 실습 개요 및 목표
* **핵심 목표**:
    1. `stash` 명령어를 통해 작업 중인 내용을 임시 저장소로 이동시킨다.
    2. 임시 저장된 목록(`list`)을 확인하고 삭제(`drop`)하거나 관리한다.
    3. 저장된 내용을 다시 작업 디렉토리로 복원(`apply`, `pop`)한다.
    4. 추적되지 않는 파일(Untracked files)을 `clean` 명령어로 정리하는 방법을 익힌다.

---

## 2. Git의 4가지 영역과 Stash
* Git은 데이터를 관리하는 3가지 영역에 **임시 저장 영역(Stash Area)**을 더해 총 4가지 영역으로 구분할 수 있음.

| 영역 | 설명 |
| :--- | :--- |
| **Working Directory** | 현재 작업 중인 파일이 있는 공간 (샌드박스) |
| **Staging Area** | 커밋(Commit)할 준비가 된 파일들을 올려두는 영역 (Index) |
| **Local Repository** | 확정된 버전(Snapshot)들이 저장되는 영역 (`.git` 폴더) |
| **Stash Area** | 작업 중인 내용을 임시로 대피시켜 두는 스택(Stack) 공간 |

---

## 3. 주요 실습 내용 (Commands & Practice)

### 3.1 임시 저장소 활용 (Basic Stash)
* **상황**: 작업 도중 급하게 다른 브랜치로 이동하거나, 커밋하기 애매한 상태일 때 사용.
* **기본 실습**:
    ```bash
    # 1. 저장소 초기화 및 파일 생성
    $ git init gstash
    $ echo 111 > f
    $ git add f
    $ git commit -m "first"

    # 2. 작업 중인 내용 임시 저장
    $ git stash
    # 또는 메시지와 함께 저장
    $ git stash save "작업 중인 내용 메모"
    ```

### 3.2 복원 및 적용 (Apply vs Pop)
* 저장된 내용을 다시 작업 공간으로 가져오는 두 가지 방법의 차이를 이해해야 함.

1.  **Stash Apply (적용만 하기)**
    * 스택에 저장된 내용은 **그대로 둠** (삭제 X).
    * `$ git stash apply`: 가장 최근 내용 적용.
    * `$ git stash apply stash@{1}`: 특정 순번의 내용 적용.
2.  **Stash Pop (꺼내오기)**
    * 내용을 적용함과 동시에 스택에서 **삭제함**.
    * `$ git stash pop`: 가장 최근 내용 적용 후 삭제.

---

## 4. 심화 실습: Untracked 파일 삭제 (Git Clean)
* `.gitignore`에 등록되지 않은 추적되지 않는 파일(Untracked files)을 강제로 지울 때 사용.

### 4.1 기본 동작 및 에러
* Git은 실수로 파일을 지우는 것을 방지하기 위해 기본 설정(`clean.requireForce`)상 바로 삭제하지 않음.
    ```bash
    $ git clean
    # 결과: fatal: clean.requireForce defaults to true... (삭제 거부)
    ```

### 4.2 대화형 삭제 (Interactive Mode)
* `-i` 옵션을 사용하여 삭제 대상을 확인하며 진행.
    ```bash
    $ git clean -i
    # 출력 예시:
    # Would remove the following items:
    #  g  h  i
    # *** Commands ***
    # 1: clean                2: filter by pattern    3: select by numbers
    # 4: ask each             5: quit                 6: help
    ```
    * **4: ask each** 선택 시 각 파일마다 삭제 여부(`y/N`)를 물어봄.

### 4.3 강제 삭제 (Force)
* 묻지 않고 즉시 삭제 (주의 필요).
    ```bash
    $ git clean -f
    # Removing g
    # Removing h
    ```

---

## 5. 핵심 요약 (Summary)
* **저장**: `$ git stash` / `$ git stash save 'msg'`
    * 작업 트리와 스테이징 영역의 변경 사항을 스택에 저장하고, 워킹 디렉토리를 깨끗하게 비움.
* **복원**:
    * `$ git stash pop`: 복원 후 목록에서 **제거**.
    * `$ git stash apply`: 복원 후 목록 **유지**.
* **청소**: `$ git clean -f` (강제 삭제) / `$ git clean -i` (대화형 삭제).