# Git 지역-원격 저장소 연동 (Push/Pull) 강의 노트

## 학습 목표

  - GitHub 계정에서 PAT(Personal Access Token)를 생성해 저장할 수 있다
  - 원격 저장소와 연동해 원격 저장소의 수정을 `pull`할 수 있다
  - 원격 저장소와 연동해 원격 저장소의 수정을 `fetch`한 후 병합할 수 있다
  - 원격 저장소와 연동해 지역 저장소의 수정을 `push`할 수 있다

-----

## 1\. Personal Access Token (PAT) 인증

### PAT 인증 필요성

#### 비밀번호 인증 종료

  - **2021년 8월 13일** 이후 GitHub는 비밀번호 인증을 완전히 중단
  - 에러 메시지:
    ```
    Support for password authentication was removed on August 13, 2021.
    Please use a personal access token instead.
    The requested URL returned error: 403
    ```

#### PAT의 특징

  - 비밀번호 인증 대신 사용하는 강화된 인증 방법
  - GitHub 계정마다 토큰 생성 필요
  - HTTPS를 통한 Git 작업 시 비밀번호 대신 사용
  - API 인증에도 사용 가능

-----

## 2\. PAT 생성 절차

### 1단계: GitHub Settings 접근

  - GitHub 로그인 후 우측 상단 프로필 클릭
  - **Settings** 선택

### 2단계: Developer Settings

  - 왼쪽 메뉴 최하단의 **Developer settings** 클릭
  - **Personal access tokens** 선택

### 3단계: 토큰 생성

  - **Generate new token** 클릭
  - 비밀번호 확인 (sudo mode 진입)
    ```
    Tip: You are entering sudo mode. 
    We won't ask for your password again for a few hours.
    ```

### 4단계: 토큰 설정

#### Note (토큰 이름)

  - 토큰 용도 설명 입력 (예: "token of repo workflow gist")

#### Expiration (만료 기간)

  - 기본값: 90일
  - 만료일 확인 및 설정

#### Select scopes (권한 범위 선택)

**필수 선택 항목:**

  - ✅ **repo**: 전체 private 저장소 제어

      - `repo:status`: 커밋 상태 접근
      - `repo_deployment`: 배포 상태 접근
      - `public_repo`: 공개 저장소 접근
      - `repo:invite`: 저장소 초대 접근

  - ✅ **workflow**: GitHub Actions 워크플로우 업데이트

  - ✅ **gist**: Gist 생성

**추가 선택 가능 항목:**

  - `write:packages`: GitHub Package Registry에 패키지 업로드
  - `read:packages`: GitHub Package Registry에서 패키지 다운로드
  - `delete:packages`: GitHub Package Registry에서 패키지 삭제
  - `admin:org`: 조직 및 팀 전체 제어
  - `admin:public_key`: 사용자 공개 키 전체 제어
  - `admin:repo_hook`: 저장소 훅 전체 제어
  - `notifications`: 알림 접근
  - `user`: 모든 사용자 데이터 업데이트
  - `read:user`: 모든 사용자 프로필 데이터 읽기
  - `user:email`: 사용자 이메일 주소 접근 (읽기 전용)
  - `user:follow`: 사용자 팔로우/언팔로우

### 5단계: 토큰 생성 완료

  - **Generate token** 버튼 클릭
  - 생성된 토큰 확인 및 복사
    ```
    ghp_iiiETQOYjAIZxrBvawwqpmK5q7vlnn11X74h
    ```

#### ⚠️ 중요 주의사항

  - **토큰은 생성 직후에만 표시됨**
  - 반드시 안전한 곳에 보관 필요
  - 재확인 불가능 (분실 시 재생성 필요)

-----

## 3\. Git Push/Pull 개념

### Push와 Pull의 일상적 비유

  - **Push**: 밀기 (올리기)
  - **Pull**: 끌기 (내리기)

### Git 구조에서의 Push/Pull

```
Working Directory → (add) → Staging Area → (commit) → Local Repository
                                                              ↓ (push)
                                                       Remote Repository
                                                              ↓ (pull)
                                                       Local Repository
```

#### Working Directory

  - 실제 작업 파일들이 있는 디렉토리

#### Staging Area

  - `git add` 명령으로 추가된 변경사항 대기 영역

#### Local Repository (PC)

  - `git commit`으로 저장된 로컬 저장소 (.git)

#### Remote Repository (GitHub)

  - GitHub 서버의 원격 저장소
  - `git remote add origin`으로 연결

-----

## 4\. Push 오류 및 해결

### 인증 오류 (403 Error)

#### 에러 메시지 1: 비밀번호 인증 거부

```bash
$ git push
remote: Support for password authentication was removed on August 13, 2021.
remote: Please see https://docs.github.com/en/get-started/getting-started-with-git/about-remote-repositories#cloning-with-https-urls 
for information on currently recommended modes of authentication.
fatal: Authentication failed for 'https://github.com/ai7dnn/git-clone.git/'
```

#### 에러 메시지 2: 권한 거부

```bash
$ git push
remote: Permission to
fatal: unable to access 'https://github.com/....git/':
The requested URL returned error: 403
```

### Windows 자격 증명 관리

#### 자격 증명 편집 방법

1.  **제어판** → **사용자 계정** → **자격 증명 관리자**
2.  **Windows 자격 증명** 탭 선택
3.  **일반 자격 증명** 섹션에서 Git 관련 항목 찾기
4.  `git:https://github.com` 항목 **편집** 또는 **제거**

#### 자격 증명 정보

  - **인터넷 또는 네트워크 주소**: `git:https://github.com`
  - **사용자 이름**: GitHub 계정명 (예: `ai7dnn`)
  - **암호**: PAT 토큰 값
  - **지속성**: 로컬 컴퓨터

### PAT를 사용한 Push

#### 토큰 포함 URL 방식

```bash
$ git push -u https://{token}@github.com/{username}/{repo_name}.git
```

#### 실제 사용 예시

```bash
$ git push -u https://ghp_TAfJF7qhxKWXAh1m8FvlLg3r1Doi832m2gJz@github.com/ai7dnn/git-clone.git
```

#### 실행 결과

```bash
Enumerating objects: 5, done.
Counting objects: 100% (5/5), done.
Delta compression using up to 12 threads
Compressing objects: 100% (2/2), done.
Writing objects: 100% (3/3), 240 bytes | 240.00 KiB/s, done.
Total 3 (delta 1), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (1/1), completed with 1 local object.
To https://github.com/ai7dnn/git-clone.git
   1470320..358adce  main -> main
branch 'main' set up to track 'https://ghp_TAfJF7qhxKWXAh1M8Fv1Lg3r1Doi832m2gJz@github.com/ai7dnn/git-clone.git/main'.
```

-----

## 5\. Git Push 명령어

### 기본 Push 명령

#### 표준 Push 형식

```bash
$ git push <저장소별칭명> <브랜치명>
```

#### 예시

```bash
$ git push origin main
```

### Push 권한 요구사항

  - **자신의 저장소**: 기본적으로 push 권한 보유
  - **타인의 저장소**: \*\*협업자(collaborator)\*\*로 등록되어야 함

### Push 동작 원리

  - 로컬 저장소의 코드 변경 이력을 원격 저장소로 전송
  - 커밋 히스토리가 원격에 반영됨

<!-- end list -->

```
Local: Working Directory → add → Staging Area → commit → Repository (master)
                                                              ↓ push
Remote: Repository (origin/master)
```

-----

## 6\. Push 명령 간소화

### 옵션 `-u` 사용

#### 최초 Push 시

```bash
$ git push -u origin main
```

  - `-u` 옵션으로 **upstream 브랜치 설정**
  - 저장소명과 브랜치명을 한 번만 입력

#### 이후 Push 시

```bash
$ git push
```

  - 저장소명과 브랜치명 생략 가능
  - 자동으로 이전 설정 사용

### `push.default` 설정

#### 설정 명령

```bash
$ git config --global push.default current
```

#### 효과

  - 로컬과 원격에서 **동일한 브랜치 이름** 사용 전제
  - 현재 브랜치를 기준으로 자동 push
  - 어느 브랜치에서든 `git push`만으로 작업 가능
  - 원격 저장소에 **동일한 브랜치명**으로 자동 업로드

-----

## 7\. Git Pull 명령어

### Pull의 구성

#### Pull = Fetch + Merge

```bash
git pull = git fetch + git merge
```

```
origin (Remote)
    ↓ Git fetch
origin/main (Local Remote Tracking Branch)
    ↓ Git merge
main (Local Branch)
```

### Pull 명령어

#### 기본 형식

```bash
$ git pull <저장소별칭명> <브랜치명>
```

#### 예시

```bash
$ git pull origin main
```

#### 간소화 형식

```bash
$ git pull
```

### Pull 동작 원리

1.  **Fetch 단계**: 원격 저장소의 정보를 로컬의 `remote/origin`으로 가져옴
2.  **Merge 단계**: 변경된 정보를 현재 브랜치와 병합

-----

## 8\. Git Fetch 명령어

### Fetch의 특징

  - 원격 저장소에서 로컬 저장소로 소스를 가져오되 **병합은 미수행**
  - 단지 소스를 가져올 뿐 병합하지 않음
  - **병합 전 검토 가능**

### Fetch 명령어

#### 기본 형식

```bash
$ git fetch <remote>
```

#### 예시

```bash
$ git fetch origin
```

### Fetch 실행 결과

```bash
$ git fetch origin
From https://github.com/ai7dnn/git-clone
   1470320..389ab6c  main       -> origin/main
```

### Fetch 후 상태 확인

```bash
$ git log --all --oneline --graph
```

#### 출력 예시

```
* 389ab6c (origin/main, origin/HEAD) Update test.md
* 358adce (HEAD -> main) 1
* 1470320 add test.md
* d510717 add file
* b04bff5 Add hello.py
* f49fff7 Update README.md
* 6be0ab8 Initial commit
```

#### 분석

  - `origin/main`, `origin/HEAD`: 최신 원격 커밋 위치
  - `HEAD -> main`: 현재 로컬 브랜치 위치
  - **원격이 로컬보다 앞서 있음** (병합 필요)

-----

## 9\. Fetch 후 병합

### 수동 병합 절차

#### 1단계: Fetch

```bash
$ git fetch origin
```

#### 2단계: Merge

```bash
$ git merge origin/main
```

### 병합 실행 예시

```bash
$ git merge origin/main
Updating 358adce..389ab6c
Fast-forward
 test.md | 3 +++
 1 file changed, 3 insertions(+)
```

### 병합 후 상태 확인

```bash
$ git log --all --oneline --graph
```

#### 출력 결과

```
* 389ab6c (HEAD -> main, origin/main, origin/HEAD) Update test.md
* 358adce 1
* 1470320 add test.md
* d510717 add file
* b04bff5 Add hello.py
* f49fff7 Update README.md
* 6be0ab8 Initial commit
```

#### 분석

  - `HEAD -> main`, `origin/main`, `origin/HEAD` **모두 동일 위치**
  - **Fast-forward 병합** 완료
  - 로컬과 원격이 동기화됨

-----

## 10\. 원격 브랜치 관리

### 모든 브랜치 확인

#### 원격 저장소 상세 정보

```bash
$ git remote show origin
```

#### 출력 예시

```
* remote origin
  Fetch URL: https://github.com/ai7dnn/git-clone.git
  Push  URL: https://github.com/ai7dnn/git-clone.git
  HEAD branch: main
  Remote branch:
    main tracked
  Local ref configured for 'git push':
    main pushes to main (up to date)
```

### 브랜치 목록 확인

```bash
$ git branch --all
```

#### 출력 예시

```
* main
  remotes/origin/HEAD -> origin/main
  remotes/origin/main
```

#### 분석

  - `* main`: 현재 로컬 브랜치
  - `remotes/origin/HEAD`: 원격 저장소의 기본 브랜치
  - `remotes/origin/main`: 원격 추적 브랜치

### 브랜치 구성 요소

#### 지역(Local) 브랜치

  - `main`: 로컬 작업 브랜치
  - `HEAD`: 현재 체크아웃된 커밋 위치

#### 원격(Remote) 브랜치

  - `origin/main`: 원격 저장소의 main 브랜치 추적
  - `origin/HEAD`: 원격 저장소의 기본 브랜치 추적

-----

## 11\. Pull vs Fetch + Merge 비교

| 구분 | Pull | Fetch + Merge |
|------|------|---------------|
| **명령어** | `git pull` | `git fetch` → `git merge origin/main` |
| **단계** | 1단계 (자동) | 2단계 (수동) |
| **병합** | 자동 병합 | 수동 병합 |
| **검토** | 검토 없음 | 병합 전 검토 가능 |
| **안전성** | 빠르지만 충돌 위험 | 안전하고 제어 가능 |
| **사용 시기** | 간단한 업데이트 | 중요한 변경사항 검토 필요 |

-----

## 12\. 핵심 명령어 요약

### 인증 관련

| 명령어 | 기능 |
|--------|------|
| PAT 생성 | GitHub Settings → Developer settings → Personal access tokens |
| PAT 포함 Push | `git push -u https://{token}@github.com/{username}/{repo}.git` |

### Push 관련

| 명령어 | 기능 |
|--------|------|
| `git push <remote> <branch>` | 지정한 원격 저장소의 브랜치로 push |
| `git push origin main` | origin의 main 브랜치로 push |
| `git push -u origin main` | upstream 설정 후 push |
| `git push` | 이전 설정 기준으로 push |
| `git config --global push.default current` | 현재 브랜치 자동 push 설정 |

### Pull 관련

| 명령어 | 기능 |
|--------|------|
| `git pull <remote> <branch>` | 지정한 원격 브랜치에서 pull |
| `git pull origin main` | origin의 main 브랜치에서 pull |
| `git pull` | 기본 원격 브랜치에서 pull |

### Fetch 관련

| 명령어 | 기능 |
|--------|------|
| `git fetch <remote>` | 원격 저장소 정보 가져오기 (병합 X) |
| `git fetch origin` | origin 원격 저장소 정보 가져오기 |
| `git merge origin/main` | 원격 브랜치와 병합 |

### 원격 브랜치 확인

| 명령어 | 기능 |
|--------|------|
| `git remote show origin` | 원격 저장소 상세 정보 |
| `git branch --all` | 로컬 및 원격 브랜치 전체 목록 |
| `git log --all --oneline --graph` | 모든 브랜치 커밋 히스토리 그래프 |
